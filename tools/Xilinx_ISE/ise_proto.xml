<?xml version="1.0" encoding="UTF-8"?>

<vdt-project>
	<tool name="ISEToolPrototype" label="ISEToolPrototype"
	    project="FPGA_project"
		interface="ISEInterface"
		package="FPGA_package"
		shell="/bin/bash"
		description="ISE tool prototype"
		abstract="true"
		>
<!-- Parameters common to all tools -->
        <!-- Not clear what is the default value for intstyle so using always -->

        <parameter	id="intstyle" label="Integration Style" tooltip= "Defines screen output"
        			default="xflow" visible="true" omit="" type="intstyleType" format="Dash"/>
        
        <parameter	id="command_files" outid="f" label="command files" tooltip= "Include command files"
        			default="" visible="true" omit="" type="Stringlist" format="DashListIndividual"/>
		
<!--   <parameter	id="part_num" outid="p" label="part number" tooltip= "Device part number"
        			default="%part" visible="true" omit="" type="String" format="Dash"/> -->

        <parameter	id="speed_grade" outid="s" label="speed grade" tooltip= "Device speed grade"
        			default="" visible="true" omit="" type="String" format="Dash"/>
		
<!-- parser parameters -->
<!-- TODO: parser is temporarily copied from Vivado, change to ISE -->
        <parameter	id="PatternErrors"   label="Errors" tooltip= "Regular expression for error messages"
        			default=".*ERROR: (\[.*\].*)\[(.*):([0-9]+)\]"
        			visible="true"  type="String" format="CopyValue"/>
        <parameter	id="PatternWarnings"   label="Warnings" tooltip= "Regular expression for warnings messages"
        			default=".*WARNING: (\[.*\].*)\[(.*):([0-9]+)\]"
        			visible="true"  type="String" format="CopyValue"/>
        <parameter	id="PatternInfo"   label="Info" tooltip= "Regular expression for info messages"
        			default=".*INFO: (\[.*\].*)\[(.*):([0-9]+)\]"
        			visible="true"  type="String" format="CopyValue"/>
        <parameter	id="NoFileProblem"   label="No-file problems" tooltip= "Report problems that do not specify particular source file/line"
        			default="true" visible="true" omit="false" type="Boolean" format="None"/>
        <parameter	id="Drc"       label="Drc"     tooltip= "Enable problems with [Drc to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="ISE_Tcl" label="ISE_Tcl"  tooltip= "Enable problems with [ISE_Tcl to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Route"     label="Route" tooltip= "Enable problems with [Route to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Memdata"   label="Memdata" tooltip= "Enable problems with [Memdata to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Synth"     label="Synth"   tooltip= "Enable problems with [Synth to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Netlist"   label="Netlist" tooltip= "Enable problems with [Netlist to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Opt"       label="Opt"     tooltip= "Enable problems with [Opt to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Project"   label="Project" tooltip= "Enable problems with [Project to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Timing"    label="Timing"  tooltip= "Enable problems with [Timing to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="Pwropt"    label="Pwropt"  tooltip= "Enable problems with [Pwropt to be reported"
        			default="true" visible="true" omit="true" type="Boolean" format="GrepFilterProblemSyntax"/>
        <parameter	id="OtherProblems"    label="Other problems"  tooltip= "Other problem patterns (after opening '[') to be suppressed)"
        			default="" visible="true" omit="" type="Stringlist" format="GrepFilterProblemOtherSyntax"/>
        <parameter id="ShowWarnings" label="Show Warnings" tooltip="Parse warning messages"
		           default="true"
		           type= "Boolean" format="None"/>
        <parameter id="ShowInfo" label="Show info" tooltip="Parse info messages"
		           default="true"
		           type= "Boolean" format="None"/>
        <parameter id="PreGrepW" visible="false"
                   type="String" format="None"
                   default="?%ShowWarnings=true: |WARNING, "/>
        <parameter id="PreGrepI" visible="false"
                   type="String" format="None"
                   default="?%ShowInfo=true: |INFO, "/>
        <parameter id="GrepEWI" label="Grep filter" tooltip="Calculated grep filter"
                   default="grep --line-buffered -E 'ERROR%PreGrepW%PreGrepI'"
                   type="String" format="CopyValue"
                   visible="true" readonly="true"/>
        			
		<input>
			<group name="Common options"
			       weight="9">
		        "intstyle"
		        "command_files"
<!-- 		    "part_num" -->
		        "speed_grade"
			</group>
			<group name="Parser"
			       weight="10">
				"ShowWarnings"
				"ShowInfo"
				"GrepEWI"
				"---"
				"NoFileProblem"
		        "Drc"
		        "ISE_Tcl"
				"Route"
				"Memdata"
				"Synth"
		        "Netlist"
		        "Opt"
		        "Project"
		        "Timing"
		        "Pwropt"
		        "OtherProblems"
				"---"
				"PatternErrors"
				"PatternWarnings"
 				"PatternInfo"
			</group>
		</input>
		<output>
			<line name=   "parser_ISE"
				errors=   "PatternErrors"
				warnings= "PatternWarnings"
				info=     "PatternInfo">
				"-c"
     			"%GrepEWI"
     			"| %ISESedPaths"
     			<if NoBabyTalk="true">
     				"| grep --line-buffered -v \"license\""
     			</if>
     			"%Drc"
		        "%ISE_Tcl"
		        "%Route"
     			"%Memdata"
     			"%Synth"
		        "%Netlist"
		        "%Opt"
		        "%Project"
		        "%Timing"
		        "%Pwropt"
		        "%OtherProblems"
		        <!-- TODO: change Placement to Routing? or such -->
     			<if NoFileProblem="true">
	  				<!-- Add  [Placement:0000] to lines that do not have [file:line] - then "Placement" will appear in "Problems" location-->
     				"| sed -u 's@^[^\[]*\[[^\[]*$@&amp;\[%%ToolName:0000\]@'"
     			</if>
			</line>
		</output>
	</tool>
</vdt-project>
